(this["webpackJsonpjitter-plot"]=this["webpackJsonpjitter-plot"]||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(36)},,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),o=a(7),r=a.n(o),c=a(4),i=a(6),l=(a(26),(e="Loading")=>s.a.createElement("h1",null,e));a(27);var d=({selectedPoint:e})=>{const t=Object.keys(e);return s.a.createElement("div",{className:"point-card"},t.map(t=>s.a.createElement("div",{key:t},"".concat(t,": ").concat(e[t]))))};const u=(e,t,a)=>{const n=t.split(",");if(0===a)e.headers=n;else{const t={};n.forEach((a,n)=>{t[e.headers[n]]=a}),e.result.push(t)}return e};const m=[{extension:".json",types:["application/json"]},{extension:".csv",types:["text/csv","application/vnd.ms-excel"]}],p=(e,t)=>{switch(t){case"application/json":try{return JSON.parse(e)}catch(a){return!1}case"text/csv":case"application/vnd.ms-excel":try{return((e="")=>e.split(/[\r\n]+/g).reduce(u,{headers:[],result:[]}).result)(e)}catch(a){return!1}default:return!1}};var h=({saveDataSet:e,setChartData:t})=>s.a.createElement("div",null,s.a.createElement("h3",null,"Upload Data"),s.a.createElement("input",{type:"file",multiple:!0,onChange:({target:{files:a}})=>{[].forEach.call(a,(a,n)=>{const s=a.name,o=new FileReader;(({name:e,type:t})=>m.some(({extension:a,types:n})=>-1!==e.search("".concat(a,"$"))&&-1!==n.indexOf(t)))(a)&&(o.onload=({target:{result:o}})=>{const r=p(o,a.type);!1===r||(e(s,r),0===n&&t(s))},o.readAsText(a))})},name:"chartData"})),E=a(15);a(28);function g(e){let t=e.icon,a=e.size,n=void 0===a?20:a,o=Object(E.a)(e,["icon","size"]);return s.a.createElement("i",Object.assign({},o,{className:"fa fa-".concat(t," icon-button"),style:{width:"".concat(n,"px"),height:"".concat(n,"px"),lineHeight:"".concat(n,"px"),fontSize:"".concat(n,"px")}}))}a(29);var v=({savedDataSets:e,saveDataSet:t,setChartData:a,deleteDataSet:n})=>s.a.createElement("div",null,s.a.createElement("h3",null,"Saved Data"),s.a.createElement("ul",null,e.map(e=>s.a.createElement("li",{className:"saved-data-set",key:e},s.a.createElement("span",{className:"saved-data-set__title",onClick:()=>a(e)},e),s.a.createElement("span",{onClick:()=>n(e)},s.a.createElement(g,{icon:"times-circle"}))))),s.a.createElement(h,{saveDataSet:t,setChartData:a})),f=(a(30),({min:e,max:t,lowerBound:a,upperBound:n,onChange:o,step:r=Math.round((t-e)/10),resizerWidth:c=10})=>{const i=100/(t-e),l=(a-e)*i,d=(t-n)*i,u=(n-a)*i;return s.a.createElement("div",{className:"range__container"},s.a.createElement("div",{className:"range__inputs"},s.a.createElement("input",{type:"number",onChange:e=>o({lowerBound:+e.target.value,upperBound:n}),step:r,value:a,max:Math.min(t,n),min:e}),s.a.createElement("input",{type:"number",onChange:e=>o({upperBound:+e.target.value,lowerBound:a}),step:r,value:n,max:t,min:Math.max(e,a)})),s.a.createElement("div",{className:"range__slider"},s.a.createElement("div",{className:"range__chunk range__chunk--start",style:{flexBasis:"".concat(l,"%")}}),s.a.createElement("div",{className:"range__control",style:{flexBasis:"".concat(c,"px")}}),s.a.createElement("div",{className:"range__chunk range__chunk--middle",style:{flexBasis:"calc(".concat(u,"% - ").concat(2*c,"px")}}),s.a.createElement("div",{className:"range__control",style:{flexBasis:"".concat(c,"px")}}),s.a.createElement("div",{className:"range__chunk range__chunk--end",style:{flexBasis:"".concat(d,"%")}})))}),S=({data:e,plots:t,metricBounds:a,updateMetricBounds:n})=>{const o={};return e.forEach(e=>{t.forEach(t=>{o[t]?e[t]<o[t].min?o[t].min=e[t]:e[t]>o[t].max&&(o[t].max=e[t]):o[t]={min:e[t],max:e[t]}})}),s.a.createElement("div",null,s.a.createElement("h2",null,"Filter Data"),t.map(e=>s.a.createElement("div",{key:e},s.a.createElement("label",null,"".concat(e," : ").concat(o[e].min," - ").concat(o[e].max)),s.a.createElement("br",null),s.a.createElement(f,{min:o[e].min,max:o[e].max,lowerBound:a[e].lowerBound,upperBound:a[e].upperBound,onChange:t=>n(e,t)}))))};a(31);var _=({styles:e,onClick:t,display:a})=>s.a.createElement("button",{onClick:t,onKeyUp:e=>{13!==e.keyCode&&32!==e.keyCode||t(e)},tabIndex:"0",style:e,className:"button"},s.a.createElement("span",null,a));const D={button:{marginLeft:"auto",marginRight:"auto"}};class P extends n.Component{constructor(){super(),this.state={}}handleFieldChange({target:{value:e}}){this.setState({selectedField:e})}submit(e){e.preventDefault(),this.props.addPlot(this.state.selectedField?this.state.selectedField:this.props.validMetrics[0])}render(){return s.a.createElement("div",null,s.a.createElement("h3",null,"Add Plot"),s.a.createElement("form",{onSubmit:e=>this.submit(e)},s.a.createElement("label",{htmlFor:"field"},"Field"),s.a.createElement("select",{onChange:e=>this.handleFieldChange(e)},this.props.validMetrics.map(e=>s.a.createElement("option",{name:"field",value:e,key:e},e))),s.a.createElement("br",null),s.a.createElement(_,{styles:D.button,type:"submit",display:"Add",onClick:e=>this.submit(e)})))}}var O=P;a(32);function T({onClick:e,isActive:t,fontIcon:a="circle"}){return s.a.createElement("button",{className:"circle-button",onClick:e},s.a.createElement("span",{className:t?"active":""},s.a.createElement("i",{className:"fa fa-".concat(a),"aria-hidden":"true"})))}const y="viewSaved",C="viewDetails",A="addPlot",b="filterData";function w({action:e,setAction:t}){return s.a.createElement("div",{className:"actionSelector"},s.a.createElement(T,{onClick:()=>t(b),isActive:e===b,fontIcon:"filter"}),s.a.createElement(T,{onClick:()=>t(y),isActive:e===y,fontIcon:"floppy-o"}),s.a.createElement(T,{onClick:()=>t(C),isActive:e===C,fontIcon:"id-card"}),s.a.createElement(T,{onClick:()=>t(A),isActive:e===A,fontIcon:"plus"}))}a(33);const x={ADD_PLOT:"ADD_PLOT",DEL_PLOT:"DEL_PLOT",SET_MODE:"SET_MODE",SELECT_POINT:"SELECT_POINT",FOCUS_POINT:"FOCUS_POINT",UPDATE_METRIC_BOUNDS:"UPDATE_METRIC_BOUNDS",SAVE_DATA_SET:"SAVE_DATA_SET",SET_DATA_SET:"SET_DATA_SET",DEL_DATA_SET:"DEL_DATA_SET"},B=e=>({type:x.DEL_PLOT,data:e}),N=(e,t)=>({type:x.SAVE_DATA_SET,data:{name:e,data:t}}),k=e=>({type:x.SET_DATA_SET,data:e}),j=e=>({type:x.SELECT_POINT,data:e}),M=e=>({type:x.FOCUS_POINT,data:e});var I=x;function L({selectedPoint:e,selectPoint:t,data:a,validMetrics:n}){return s.a.createElement("div",{className:"jp-ctrl__header"},s.a.createElement("label",{htmlFor:"agent"},"Agent"),s.a.createElement("select",{name:"agent",value:e.id,onChange:F(a,t)},a.map(e=>s.a.createElement("option",{key:e.id,value:e.id},e.name||e.first_name||e[n[0]]))))}const F=(e,t)=>a=>{const n=+a.target.value;let s;e.some(e=>(e.id===n&&(s=e),s)),t(s)};function U({loading:e,mode:t,validMetrics:a,addPlot:n,deleteDataSet:o,saveDataSet:r,setDataSet:c,data:i,savedDataSets:u,metricBounds:m,updateMetricBounds:p,focusedPoint:h,selectedPoint:E,plots:g}){if(e)return s.a.createElement(l,null);switch(t){case A:return s.a.createElement(O,{validMetrics:a,addPlot:e=>n(e)});case y:return s.a.createElement(v,{savedDataSets:u,saveDataSet:r,deleteDataSet:o,setChartData:c});case b:return s.a.createElement(S,{data:i,plots:g,metricBounds:m,updateMetricBounds:p});case C:return s.a.createElement(d,{focusedPoint:h,selectedPoint:E});default:return s.a.createElement("div",null,"Unknown mode")}}var R=Object(c.b)(({mode:e,dataSet:{plots:t,validMetrics:a,data:n,selectedPoint:s,focusedPoint:o,metricBounds:r,savedDataSets:c},loading:i,userConfig:l})=>({mode:e,plots:t,validMetrics:a,metricBounds:r,savedDataSets:c,data:n,selectedPoint:s,focusedPoint:o,loading:i,userConfig:l}),e=>({addPlot:t=>{e((e=>({type:x.ADD_PLOT,data:e}))(t))},delPlot:t=>{e(B(t))},setMode:t=>{e((e=>({type:x.SET_MODE,data:e}))(t))},saveDataSet:(t,a)=>{e(N(t,a))},setDataSet:t=>{e(k(t))},deleteDataSet:t=>{e((e=>({type:x.DEL_DATA_SET,data:e}))(t))},selectPoint:t=>{e(j(t))},focusPoint:t=>{e(M(t))},updateMetricBounds:(t,a)=>{e(((e,t)=>({type:x.UPDATE_METRIC_BOUNDS,data:{bounds:t,metric:e}}))(t,a))}}))(e=>s.a.createElement("div",{className:"jp-ctrl"},s.a.createElement(L,e),s.a.createElement("hr",null),s.a.createElement(U,e),s.a.createElement(w,{action:e.mode,setAction:e.setMode}))),H=a(3);class W extends n.Component{componentDidUpdate(){this.renderAxis()}componentDidMount(){this.renderAxis()}renderAxis(){var e=r.a.findDOMNode(this);Object(H.f)(e).call(this.props.axis)}render(){return s.a.createElement("g",{className:"axis gray-stroke",stroke:"grey",transform:"translate(0, 0)"})}}var J=W;class V extends n.Component{constructor(e){super(e),this.state={isHover:!1,cx:this.randX()}}getOpacity(){let e;return e=this.props.isFocusedPoint||this.state&&this.state.isHover?1:this.props.isSelectedPoint?.8:.6,e}hoverMenu(e){this.setState({isHover:e})}randX(){const e=this.props,t=e.isSelectedPoint,a=e.radius,n=e.plotWidth;return t?150:Math.floor(Math.random()*(n-a/2))+a/2}getFill(){const e=this.props,t=e.isOutOfRange,a=e.isSelectedPoint,n=e.colors,s=void 0===n?{}:n,o=s.selected,r=void 0===o?"#db4437":o,c=s.selectedDisabled,i=void 0===c?"#d5dc7e":c,l=s.enabled,d=void 0===l?"#4285f4":l,u=s.disabled;return t?a?i:void 0===u?"lightgray":u:a?r:d}getStroke(){let e;return this.props.isFocusedPoint?e="white":this.state.isHover&&(e="black"),e}getStrokeWidth(){if(this.props.isFocusedPoint||this.state.isHover)return 1}render(){return s.a.createElement("circle",{cx:this.state.cx,cy:this.props.cy,r:this.props.radius,data:this.props.data.bmi,fillOpacity:this.getOpacity(),stroke:this.getStroke(),strokeWidth:this.getStrokeWidth(),onMouseEnter:e=>this.hoverMenu(!0),onMouseLeave:e=>this.hoverMenu(!1),onClick:()=>this.props.onPointClick(),fill:this.getFill()})}}var z=V;a(34);const Y={radius:10,margin:{top:10,side:10},svgStyle:{padding:"10px",borderTop:"2px solid",borderBottom:"2px solid"},height:[30,25,100,96].reduce((e,t)=>e-t,window.innerHeight),width:300};class G extends n.Component{constructor(e){super(e);const t=this.props,a=t.metric,n=t.data,s=Object(H.b)(n,e=>Math.round(e[a])),o=Object(H.c)(n,e=>Math.round(e[a]));let r=Object(H.d)().domain([o,s]).range([Y.height-Y.margin.top,0]);(a.includes("date")||a.includes("day"))&&(r=Object(H.e)().range([Y.height-Y.margin.top,o])),this.state={yScale:r,max:s,min:o}}getY(e){return this.state.yScale(e)}isSelectedPoint({id:e}){return this.props.selectedPoint.id===e}renderFooter(){const e=this.props,t=e.selectedPoint.id,a=e.data,n=e.metric;let o=-1;a.sort((e,t)=>Math.round(e[n])-Math.round(t[n])).some(({id:e},a)=>(e===t&&(o=a+1),-1!==o));const r="".concat(o," of ").concat(a.length),c="Percentile: "+Math.round(o/a.length*100)+"%",i=0!==a.length;return s.a.createElement("div",{className:"j-plot__footer"},s.a.createElement("h3",null,i?r:""),i&&s.a.createElement("h4",null,c))}renderHeader(){const e=this.props,t=e.metric,a=e.data;return s.a.createElement("h2",{className:"j-plot__header"},a.length?t:"No Data")}renderBody(){const e=this.props,t=e.metric,a=e.data,n=e.metricBounds,o=e.focusedPoint,r=e.onPointClick,c=e.userConfig,i=this.state,l=i.max,d=i.min,u=i.yScale,m=[d];n.lowerBound!==d&&m.push(n.lowerBound),n.upperBound!==l&&n.upperBound!==n.lowerBound&&m.push(n.upperBound),n.lowerBound!==l&&m.push(l);const p=Object(H.a)(u).tickValues(m),h={selected:c.colors.primary};return a.length?s.a.createElement("svg",{width:Y.width,height:Y.height,style:Y.svgStyle},s.a.createElement("g",null,s.a.createElement(J,{height:Y.height-Y.margin.top,axis:p}),a.map(e=>s.a.createElement(z,{colors:h,key:e.id,cy:this.getY(Math.round(e[t])),radius:Y.radius,isFocusedPoint:o===e,isSelectedPoint:this.isSelectedPoint(e),isOutOfRange:n.lowerBound>e[t]||n.upperBound<e[t],onPointClick:()=>r(e),plotWidth:Y.width,data:e})))):s.a.createElement("div",{style:{width:Y.width,height:Y.height}})}render(){return s.a.createElement("div",{className:"j-plot"},this.renderHeader(),this.renderBody(),this.renderFooter())}}G.defaultProps={data:[],metric:"",selectedPoint:{},metricBounds:{}};var $=G;a(35);class K extends n.Component{componentDidMount(){const e=this.props,t=e.data,a=e.savedDataSets,n=e.saveDataSet,s=e.setDataSet,o=[{name:"Random People 1",src:"./MOCK_DATA_1.json"},{name:"Random People 2",src:"./MOCK_DATA_2.json"},{name:"Chicago Gas Stations",src:"https://data.cityofchicago.org/resource/f7f2-ggz5.json?$limit=100&$offset=100"}];0===a.length&&o.forEach((e,a)=>{fetch(e.src).then(e=>e.json()).then(o=>{n(e.name,o),0===a&&0===t.length&&s(e.name)})})}onPointClick(e){e.id===this.props.selectedPoint.id?this.drillIntoPoint(e):e.id===this.props.focusedPoint.id?this.props.selectPoint(e):this.props.focusPoint(e)}drillIntoPoint(e){console.log("todo: drill into point")}render(){const e=this.props,t=e.selectedPoint,a=e.selectedDataSet,n=e.plots,o=e.data,r=e.delPlot,c=e.metricBounds,i=e.focusedPoint,l=e.userConfig;return s.a.createElement("div",{className:"app-container"},s.a.createElement(R,null),s.a.createElement("div",{className:"app-container__jp-holder"},s.a.createElement("h3",{className:"app-container__jp-title"},a),n.map((e,a)=>s.a.createElement($,{userConfig:l,key:a+e,selectedPoint:t,onPointClick:e=>this.onPointClick(e),focusedPoint:i,metric:e,metricBounds:c[e],delPlot:()=>r(e),data:o})),!n.length&&s.a.createElement("h4",{className:"app-container__no-plots"},"Add some plots!")))}}var X=Object(c.b)(({dataSet:{plots:e,selectedDataSet:t,metricBounds:a,data:n,savedDataSets:s,selectedPoint:o,focusedPoint:r},userConfig:c})=>({plots:e,selectedDataSet:t,metricBounds:a,data:n,savedDataSets:s,selectedPoint:o,focusedPoint:r,userConfig:c}),e=>({delPlot:t=>{e(B(t))},saveDataSet:(t,a)=>{e(N(t,a))},setDataSet:t=>{e(k(t))},selectPoint:t=>{e(j(t))},focusPoint:t=>{e(M(t))}}))(K),q=a(1);const Q={colors:{primary:"#ffee10"}};var Z=(e=Q,t)=>{switch(t.type){case I.PRIMARY_COLOR_CHANGE:return Object(q.a)({},e,{colors:Object(q.a)({},e.colors,{primary:t.data})});default:return e}};const ee=window.localStorage,te={data:[],plots:[],savedDataSets:[],selectedDataSet:"",selectedPoint:{},focusedPoint:{},validMetrics:[],metricBounds:{}};var ae=(e=te,t)=>{switch(t.type){case I.SELECT_POINT:return Object(q.a)({},e,{selectedPoint:t.data});case I.FOCUS_POINT:return Object(q.a)({},e,{focusedPoint:t.data});case I.UPDATE_METRIC_BOUNDS:return Object(q.a)({},e,{metricBounds:Object(q.a)({},e.metricBounds,{[t.data.metric]:t.data.bounds})});case I.ADD_PLOT:return Object(q.a)({},e,{plots:-1===e.plots.indexOf(t.data)?[...e.plots,t.data]:[...e.plots]});case I.DEL_PLOT:return Object(q.a)({},e,{plots:e.plots.filter(e=>e!==t.data)});case I.SAVE_DATA_SET:return((e,t)=>{ee.setItem(e,JSON.stringify(t))})(t.data.name,t.data.data),Object(q.a)({},e,{savedDataSets:[...e.savedDataSets,t.data.name]});case I.DEL_DATA_SET:return a=t.data,ee.removeItem(a),Object(q.a)({},e,{savedDataSets:e.savedDataSets.filter(e=>e!==t.data)});case I.SET_DATA_SET:const n=(e=>JSON.parse(ee.getItem(e)))(t.data),s=Object.keys(n[0]).filter(e=>!isNaN(+n[0][e])&&""!==n[0][e]);return Object(q.a)({},e,{data:n,selectedDataSet:t.data,selectedPoint:n[0],focusedPoint:n[0],validMetrics:s,metricBounds:s.reduce((e,t)=>Object(q.a)({},e,{[t]:{upperBound:Object(H.b)(n,e=>Math.round(e[t])),lowerBound:Object(H.c)(n,e=>Math.round(e[t]))}}),{}),plots:s});default:return e}var a};const ne={loading:!1,mode:"viewDetails",configOpen:!1,userConfig:Q,dataSet:te,__version:2};const se=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function oe(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const t=e.installing;t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(e=>{console.error("Error during service worker registration:",e)})}const re=e=>Object.assign({},e,{userConfig:Q,__version:1}),ce=({loading:e,mode:t,validMetrics:a,plots:n,selectedPoint:s,focusedPoint:o,chartData:r,metricBounds:c,configOpen:i,userConfig:l})=>{const d=JSON.parse(window.localStorage.getItem("savedDataSets"))||{};window.localStorage.removeItem("savedDataSets");const u=Object.keys(d).reduce((e,t)=>d[t]?[...e,t]:[...e],[]);return{loading:e,mode:t,configOpen:i,userConfig:l,dataSet:{data:r,plots:n,savedDataSets:u,selectedDataSet:u.length>0?u[0]:r.length>0?"Unknown Data Set":"",selectedPoint:s,focusedPoint:o,validMetrics:a,metricBounds:c},__version:2}};var ie=e=>{switch(e.__version){case 0:e=re(e);case 1:e=ce(e);default:return e}};const le=Object(i.c)((e=ne,t)=>{const a=t.data;switch(t.type){case I.SET_MODE:return Object(q.a)({},e,{mode:a});case I.SHOW_CONFIG:return Object(q.a)({},e,{configOpen:a});case I.PRIMARY_COLOR_CHANGE:case I.UPDATE_PRIMARY_COLOR_DEFAULT:return Object(q.a)({},e,{userConfig:Z(e.userConfig,t)});case I.UPDATE_METRIC_BOUNDS:case I.SELECT_POINT:case I.FOCUS_POINT:case I.SAVE_DATA_SET:case I.SET_DATA_SET:case I.DEL_DATA_SET:case I.DEL_PLOT:case I.ADD_PLOT:return Object(q.a)({},e,{dataSet:ae(e.dataSet,t)});default:return e}},(()=>{if(null!==localStorage.getItem("reduxState")){const e=JSON.parse(localStorage.getItem("reduxState"));return ie(e)}})(),Object(i.a)(({getState:e})=>t=>a=>{const n=t(a);return localStorage.setItem("reduxState",JSON.stringify(e())),n}));r.a.render(s.a.createElement(c.a,{store:le},s.a.createElement(X,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/jitter-plot",window.location).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="".concat("/jitter-plot","/service-worker.js");se?function(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):oe(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e):oe(e)})}}()}],[[16,1,2]]]);
//# sourceMappingURL=main.07c30c3b.chunk.js.map