(this["webpackJsonpjitter-plot"]=this["webpackJsonpjitter-plot"]||[]).push([[0],[,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(36)},,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(7),r=a.n(s),c=a(4),i=a(6),l=(a(27),a(8)),d=(e="Loading")=>o.a.createElement("h1",null,e);a(28);var u=({selectedPoint:e})=>{const t=Object.keys(e);return o.a.createElement("div",{className:"point-card"},t.map(t=>o.a.createElement("div",{key:t},"".concat(t,": ").concat(e[t]))))};const m=(e,t,a)=>{const n=t.split(",");if(0===a)e.headers=n;else{const t={};n.forEach((a,n)=>{t[e.headers[n]]=a}),e.result.push(t)}return e};const p=[{extension:".json",types:["application/json"]},{extension:".csv",types:["text/csv","application/vnd.ms-excel"]}],h=(e,t)=>{switch(t){case"application/json":try{return JSON.parse(e)}catch(a){return!1}case"text/csv":case"application/vnd.ms-excel":try{return((e="")=>e.split(/[\r\n]+/g).reduce(m,{headers:[],result:[]}).result)(e)}catch(a){return!1}default:return!1}};var E=({saveDataSet:e,setChartData:t})=>o.a.createElement("div",null,o.a.createElement("h3",null,"Upload Data"),o.a.createElement("input",{type:"file",multiple:!0,onChange:({target:{files:a}})=>{[].forEach.call(a,(a,n)=>{const o=a.name,s=new FileReader;(({name:e,type:t})=>p.some(({extension:a,types:n})=>-1!==e.search("".concat(a,"$"))&&-1!==n.indexOf(t)))(a)&&(s.onload=({target:{result:s}})=>{const r=h(s,a.type);!1===r||(e(o,r),0===n&&t(o))},s.readAsText(a))})},name:"chartData"})),v=a(16);a(29);function g(e){let t=e.icon,a=e.size,n=void 0===a?20:a,s=Object(v.a)(e,["icon","size"]);return o.a.createElement("i",Object.assign({},s,{className:"fa fa-".concat(t," icon-button"),style:{width:"".concat(n,"px"),height:"".concat(n,"px"),lineHeight:"".concat(n,"px"),fontSize:"".concat(n,"px")}}))}a(30);var f=({savedDataSets:e,saveDataSet:t,setChartData:a,deleteDataSet:n})=>o.a.createElement("div",null,o.a.createElement("h3",null,"Saved Data"),o.a.createElement("ul",null,e.map(e=>o.a.createElement("li",{className:"saved-data-set",key:e},o.a.createElement("span",{className:"saved-data-set__title",onClick:()=>a(e)},e),o.a.createElement("span",{onClick:()=>n(e)},o.a.createElement(g,{icon:"times-circle"}))))),o.a.createElement(E,{saveDataSet:t,setChartData:a}));a(31);function S({min:e,max:t,lowerBound:a,upperBound:n,onChange:s,step:r=Math.round((t-e)/10),resizerWidth:c=10}){const i=100/(t-e),d=(a-e)*i,u=(t-n)*i,m=(n-a)*i,p=o.a.useState(!1),h=Object(l.a)(p,2),E=h[0],v=h[1];function g(a,n){v({control:a,start:n.clientX,pxValue:(+t-+e)/n.target.parentElement.getBoundingClientRect().width})}return o.a.useEffect(()=>{if(E&&E.start){function o(o){const r=-1*(E.start-+o.clientX)*E.pxValue,c="MIN"===E.control?{upperBound:n,lowerBound:Math.min(Math.max(e,a+r),n)}:{lowerBound:a,upperBound:Math.max(Math.min(t,n+r),a)};s(c)}window.addEventListener("mousemove",o),window.addEventListener("mouseup",(function e(t){v(null),window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",e)}))}},[E]),o.a.createElement("div",{className:"range__container"},o.a.createElement("div",{className:"range__inputs"},o.a.createElement("input",{type:"number",onChange:e=>s({lowerBound:+e.target.value,upperBound:n}),step:r,value:a,max:Math.min(t,n),min:e}),o.a.createElement("input",{type:"number",onChange:e=>s({upperBound:+e.target.value,lowerBound:a}),step:r,value:n,max:t,min:Math.max(e,a)})),o.a.createElement("div",{className:"range__slider"},o.a.createElement("div",{className:"range__chunk range__chunk--start",style:{flexBasis:"".concat(d,"%")}}),o.a.createElement("div",{className:"range__control",onMouseDown:e=>g("MIN",e),style:{flexBasis:"".concat(c,"px")}}),o.a.createElement("div",{className:"range__chunk range__chunk--middle",style:{flexBasis:"calc(".concat(m,"% - ").concat(2*c,"px")}}),o.a.createElement("div",{className:"range__control",onMouseDown:e=>g("MAX",e),style:{flexBasis:"".concat(c,"px")}}),o.a.createElement("div",{className:"range__chunk range__chunk--end",style:{flexBasis:"".concat(u,"%")}})))}var _=({data:e,plots:t,metricBounds:a,updateMetricBounds:n})=>{const s={};return e.forEach(e=>{t.forEach(t=>{s[t]?e[t]<s[t].min?s[t].min=e[t]:e[t]>s[t].max&&(s[t].max=e[t]):s[t]={min:e[t],max:e[t]}})}),o.a.createElement("div",null,o.a.createElement("h2",null,"Filter Data"),t.map(e=>o.a.createElement("div",{key:e},o.a.createElement("label",null,"".concat(e," : ").concat(s[e].min," - ").concat(s[e].max)),o.a.createElement("br",null),o.a.createElement(S,{min:s[e].min,max:s[e].max,lowerBound:a[e].lowerBound,upperBound:a[e].upperBound,onChange:t=>n(e,t)}))))};function D(e){return function(e){return e.replace(/\W/,"-")}("plot-".concat(e))}function P({metrics:e,selectedMetrics:t,delPlot:a,addPlot:n}){return o.a.createElement(o.a.Fragment,null,o.a.createElement("h3",null,"Metrics"),o.a.createElement("ul",{style:{listStyle:"none",paddingLeft:0}},e.map(e=>o.a.createElement("li",{key:e,style:{padding:10}},o.a.createElement("input",{type:"checkbox",name:D(e),id:D(e),checked:t.includes(e),onChange:t=>t.target.checked?n(e):a(e)}),o.a.createElement("label",{htmlFor:D(e)},e)))))}a(32);function O({onClick:e,isActive:t,fontIcon:a="circle"}){return o.a.createElement("button",{className:"circle-button",onClick:e},o.a.createElement("span",{className:t?"active":""},o.a.createElement("i",{className:"fa fa-".concat(a),"aria-hidden":"true"})))}const T="viewSaved",y="viewDetails",w="addPlot",A="filterData";function x({action:e,setAction:t}){return o.a.createElement("div",{className:"actionSelector"},o.a.createElement(O,{onClick:()=>t(A),isActive:e===A,fontIcon:"filter"}),o.a.createElement(O,{onClick:()=>t(T),isActive:e===T,fontIcon:"floppy-o"}),o.a.createElement(O,{onClick:()=>t(y),isActive:e===y,fontIcon:"id-card"}),o.a.createElement(O,{onClick:()=>t(w),isActive:e===w,fontIcon:"plus"}))}a(33);const B={ADD_PLOT:"ADD_PLOT",DEL_PLOT:"DEL_PLOT",SELECT_POINT:"SELECT_POINT",FOCUS_POINT:"FOCUS_POINT",UPDATE_METRIC_BOUNDS:"UPDATE_METRIC_BOUNDS",SAVE_DATA_SET:"SAVE_DATA_SET",SET_DATA_SET:"SET_DATA_SET",DEL_DATA_SET:"DEL_DATA_SET"},b=(e,t)=>({type:B.SAVE_DATA_SET,data:{name:e,data:t}}),N=e=>({type:B.SET_DATA_SET,data:e}),k=e=>({type:B.SELECT_POINT,data:e}),C=e=>({type:B.FOCUS_POINT,data:e});var j=B;function M({selectedPoint:e,selectPoint:t,data:a,validMetrics:n}){return o.a.createElement("div",{className:"jp-ctrl__header"},o.a.createElement("label",{htmlFor:"agent"},"Agent"),o.a.createElement("select",{name:"agent",value:e&&e.id,onChange:L(a,t)},a.map(e=>o.a.createElement("option",{key:e.id,value:e.id},e.name||e.first_name||e[n[0]]))))}const L=(e,t)=>a=>{const n=+a.target.value;let o;e.some(e=>(e.id===n&&(o=e),o)),t(o)};function I({loading:e,mode:t,validMetrics:a,addPlot:n,delPlot:s,deleteDataSet:r,saveDataSet:c,setDataSet:i,data:l,savedDataSets:m,metricBounds:p,updateMetricBounds:h,focusedPoint:E,selectedPoint:v,plots:g}){if(e)return o.a.createElement(d,null);switch(t){case w:return o.a.createElement(P,{metrics:a,selectedMetrics:g,addPlot:n,delPlot:s});case T:return o.a.createElement(f,{savedDataSets:m,saveDataSet:c,deleteDataSet:r,setChartData:i});case A:return o.a.createElement(_,{data:l,plots:g,metricBounds:p,updateMetricBounds:h});case y:return o.a.createElement(u,{focusedPoint:E,selectedPoint:v});default:return o.a.createElement("div",null,"Unknown mode")}}var U=Object(c.b)(({dataSet:{plots:e,validMetrics:t,data:a,selectedPoint:n,focusedPoint:o,metricBounds:s,savedDataSets:r},loading:c,userConfig:i})=>({plots:e,validMetrics:t,metricBounds:s,savedDataSets:r,data:a,selectedPoint:n,focusedPoint:o,loading:c,userConfig:i}),e=>({addPlot:t=>{e((e=>({type:B.ADD_PLOT,data:e}))(t))},delPlot:t=>{e({type:B.DEL_PLOT,data:t})},saveDataSet:(t,a)=>{e(b(t,a))},setDataSet:t=>{e(N(t))},deleteDataSet:t=>{e((e=>({type:B.DEL_DATA_SET,data:e}))(t))},selectPoint:t=>{e(k(t))},focusPoint:t=>{e(C(t))},updateMetricBounds:(t,a)=>{e(((e,t)=>({type:B.UPDATE_METRIC_BOUNDS,data:{bounds:t,metric:e}}))(t,a))}}))((function(e){const t=o.a.useState(w),a=Object(l.a)(t,2),n=a[0],s=a[1];return o.a.createElement("div",{className:"jp-ctrl"},o.a.createElement(M,e),o.a.createElement("hr",null),o.a.createElement("div",{className:"jp-ctrl__body"},o.a.createElement(I,Object.assign({},e,{mode:n}))),o.a.createElement(x,{action:n,setAction:s}))})),F=a(3);class R extends n.Component{componentDidUpdate(){this.renderAxis()}componentDidMount(){this.renderAxis()}renderAxis(){var e=r.a.findDOMNode(this);Object(F.f)(e).call(this.props.axis)}render(){return o.a.createElement("g",{className:"axis gray-stroke",stroke:"grey",transform:"translate(0, 0)"})}}var W=R;class H extends n.Component{constructor(e){super(e),this.state={isHover:!1,cx:this.randX()}}getOpacity(){let e;return e=this.props.isFocusedPoint||this.state&&this.state.isHover?1:this.props.isSelectedPoint?.8:.6,e}hoverMenu(e){this.setState({isHover:e})}randX(){const e=this.props,t=e.isSelectedPoint,a=e.radius,n=e.plotWidth;return t?150:Math.floor(Math.random()*(n-a/2))+a/2}getFill(){const e=this.props,t=e.isOutOfRange,a=e.isSelectedPoint,n=e.colors,o=void 0===n?{}:n,s=o.selected,r=void 0===s?"#ffee10":s,c=o.selectedDisabled,i=void 0===c?"#d5dc7e":c,l=o.enabled,d=void 0===l?"#4285f4":l,u=o.disabled;return t?a?i:void 0===u?"lightgray":u:a?r:d}getStroke(){let e;return this.props.isFocusedPoint?e="white":this.state.isHover&&(e="black"),e}getStrokeWidth(){if(this.props.isFocusedPoint||this.state.isHover)return 1}render(){return o.a.createElement("circle",{cx:this.state.cx,cy:this.props.cy,r:this.props.radius,data:this.props.data.bmi,fillOpacity:this.getOpacity(),stroke:this.getStroke(),strokeWidth:this.getStrokeWidth(),onMouseEnter:e=>this.hoverMenu(!0),onMouseLeave:e=>this.hoverMenu(!1),onClick:()=>this.props.onPointClick(),fill:this.getFill()})}}var V=H;a(34);const J={radius:10,margin:{top:10,side:10},svgStyle:{padding:"10px",borderTop:"2px solid",borderBottom:"2px solid"},height:[30,25,100,132].reduce((e,t)=>e-t,window.innerHeight),width:300};class z extends n.Component{constructor(e){super(e);const t=this.props,a=t.metric,n=t.data,o=Object(F.b)(n,e=>Math.round(e[a])),s=Object(F.c)(n,e=>Math.round(e[a]));let r=Object(F.d)().domain([s,o]).range([J.height-J.margin.top,0]);(a.includes("date")||a.includes("day"))&&(r=Object(F.e)().range([J.height-J.margin.top,s])),this.state={yScale:r,max:o,min:s}}getY(e){return this.state.yScale(e)}isSelectedPoint({id:e}){return this.props.selectedPoint.id===e}renderFooter(){const e=this.props,t=e.selectedPoint.id,a=e.data,n=e.metric;let s=-1;a.sort((e,t)=>Math.round(e[n])-Math.round(t[n])).some(({id:e},a)=>(e===t&&(s=a+1),-1!==s));const r="".concat(s," of ").concat(a.length),c="Percentile: "+Math.round(s/a.length*100)+"%",i=0!==a.length;return o.a.createElement("div",{className:"j-plot__footer"},o.a.createElement("h3",null,i?r:""),i&&o.a.createElement("h4",null,c))}renderHeader(){const e=this.props,t=e.metric,a=e.data;return o.a.createElement("h2",{className:"j-plot__header"},a.length?t:"No Data")}renderBody(){const e=this.props,t=e.metric,a=e.data,n=e.metricBounds,s=e.focusedPoint,r=e.onPointClick,c=this.state,i=c.max,l=c.min,d=c.yScale,u=[l];n.lowerBound!==l&&u.push(n.lowerBound),n.upperBound!==i&&n.upperBound!==n.lowerBound&&u.push(n.upperBound),n.lowerBound!==i&&u.push(i);const m=Object(F.a)(d).tickValues(u);return a.length?o.a.createElement("svg",{width:J.width,height:J.height,style:J.svgStyle},o.a.createElement("g",null,o.a.createElement(W,{height:J.height-J.margin.top,axis:m}),a.map(e=>o.a.createElement(V,{key:e.id,cy:this.getY(Math.round(e[t])),radius:J.radius,isFocusedPoint:s===e,isSelectedPoint:this.isSelectedPoint(e),isOutOfRange:n.lowerBound>e[t]||n.upperBound<e[t],onPointClick:()=>r(e),plotWidth:J.width,data:e})))):o.a.createElement("div",{style:{width:J.width,height:J.height}})}render(){return o.a.createElement("div",{className:"j-plot"},this.renderHeader(),this.renderBody(),this.renderFooter())}}z.defaultProps={data:[],metric:"",selectedPoint:{},metricBounds:{}};var X=z;a(35);class $ extends n.Component{componentDidMount(){const e=this.props,t=e.data,a=e.savedDataSets,n=e.saveDataSet,o=e.setDataSet,s=[{name:"Random People 1",src:"./MOCK_DATA_1.json"},{name:"Random People 2",src:"./MOCK_DATA_2.json"},{name:"Chicago Gas Stations",src:"https://data.cityofchicago.org/resource/f7f2-ggz5.json?$limit=100&$offset=100"}];0===a.length&&s.forEach((e,a)=>{fetch(e.src).then(e=>e.json()).then(s=>{n(e.name,s),0===a&&0===t.length&&o(e.name)})})}onPointClick(e){e.id===this.props.selectedPoint&&this.props.selectedPoint.id?this.drillIntoPoint(e):e.id===this.props.focusedPoint.id?this.props.selectPoint(e):this.props.focusPoint(e)}drillIntoPoint(e){console.log("todo: drill into point")}render(){const e=this.props,t=e.selectedPoint,a=e.selectedDataSet,n=e.plots,s=e.data,r=e.metricBounds,c=e.focusedPoint;return o.a.createElement("div",{className:"app-container"},o.a.createElement(U,null),o.a.createElement("div",{className:"app-container__jp-holder"},o.a.createElement("h3",{className:"app-container__jp-title"},a),n.map((e,a)=>o.a.createElement(X,{key:a+e,selectedPoint:t,onPointClick:e=>this.onPointClick(e),focusedPoint:c,metric:e,metricBounds:r[e],data:s})),!n.length&&o.a.createElement("h4",{className:"app-container__no-plots"},"Add some plots!")))}}var K=Object(c.b)(({dataSet:{plots:e,selectedDataSet:t,metricBounds:a,data:n,savedDataSets:o,selectedPoint:s,focusedPoint:r}})=>({plots:e,selectedDataSet:t,metricBounds:a,data:n,savedDataSets:o,selectedPoint:s,focusedPoint:r}),e=>({saveDataSet:(t,a)=>{e(b(t,a))},setDataSet:t=>{e(N(t))},selectPoint:t=>{e(k(t))},focusPoint:t=>{e(C(t))}}))($),Y=a(1);const G=window.localStorage,q={data:[],plots:[],savedDataSets:[],selectedDataSet:"",selectedPoint:{},focusedPoint:{},validMetrics:[],metricBounds:{}};var Q=(e=q,t)=>{switch(t.type){case j.SELECT_POINT:return Object(Y.a)({},e,{selectedPoint:t.data});case j.FOCUS_POINT:return Object(Y.a)({},e,{focusedPoint:t.data});case j.UPDATE_METRIC_BOUNDS:return Object(Y.a)({},e,{metricBounds:Object(Y.a)({},e.metricBounds,{[t.data.metric]:t.data.bounds})});case j.ADD_PLOT:return Object(Y.a)({},e,{plots:-1===e.plots.indexOf(t.data)?[...e.plots,t.data]:[...e.plots]});case j.DEL_PLOT:return Object(Y.a)({},e,{plots:e.plots.filter(e=>e!==t.data)});case j.SAVE_DATA_SET:return((e,t)=>{G.setItem(e,JSON.stringify(t))})(t.data.name,t.data.data),Object(Y.a)({},e,{savedDataSets:[...e.savedDataSets,t.data.name]});case j.DEL_DATA_SET:return a=t.data,G.removeItem(a),Object(Y.a)({},e,{savedDataSets:e.savedDataSets.filter(e=>e!==t.data)});case j.SET_DATA_SET:const n=(e=>JSON.parse(G.getItem(e)))(t.data),o=Object.keys(n[0]).filter(e=>!isNaN(+n[0][e])&&""!==n[0][e]);return Object(Y.a)({},e,{data:n,selectedDataSet:t.data,selectedPoint:n[0],focusedPoint:n[0],validMetrics:o,metricBounds:o.reduce((e,t)=>Object(Y.a)({},e,{[t]:{upperBound:Object(F.b)(n,e=>Math.round(e[t])),lowerBound:Object(F.c)(n,e=>Math.round(e[t]))}}),{}),plots:o});default:return e}var a};const Z={loading:!1,configOpen:!1,dataSet:q,__version:2};const ee=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function te(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const t=e.installing;t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(e=>{console.error("Error during service worker registration:",e)})}const ae=Object(i.c)((e=Z,t)=>{switch(t.type){case j.UPDATE_METRIC_BOUNDS:case j.SELECT_POINT:case j.FOCUS_POINT:case j.SAVE_DATA_SET:case j.SET_DATA_SET:case j.DEL_DATA_SET:case j.DEL_PLOT:case j.ADD_PLOT:return Object(Y.a)({},e,{dataSet:Q(e.dataSet,t)});default:return e}},(()=>{if(null!==localStorage.getItem("reduxState"))return JSON.parse(localStorage.getItem("reduxState"))})(),Object(i.a)(({getState:e})=>t=>a=>{const n=t(a);return localStorage.setItem("reduxState",JSON.stringify(e())),n}));r.a.render(o.a.createElement(c.a,{store:ae},o.a.createElement(K,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/jitter-plot",window.location).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="".concat("/jitter-plot","/service-worker.js");ee?function(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):te(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e):te(e)})}}()}],[[17,1,2]]]);
//# sourceMappingURL=main.4d54835e.chunk.js.map